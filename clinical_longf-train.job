#PBS -l select=1:ncpus=10:ngpus=1
#PBS -P CSCI1335
#PBS -q gpu_1
#PBS -o /mnt/lustre/users/ynurmahomed/logs/clinical_longf-train/
#PBS -e /mnt/lustre/users/ynurmahomed/logs/clinical_longf-train/
#PBS -l walltime=00:30:00
#PBS -WMail_Users=nrmyas001@myuct.ac.za

module load python/anaconda-python-3.7
cd /home/nrmyas001/clinical-longformer
source .venv/bin/activate

export TOKENIZERS_PARALLELISM=False
export SEQ_LEN=2048

python -m src.clinical_longformer.model.bert \
    /scrath/nrmyas001/datasets/discharge/$SEQ_LEN \
    --bert_pretrained_path=/scratch/nrmyas001/.data/pretraining_output/bert_uncased_L-12_H-768_A-12-$SEQ_LEN/$SEQ_LEN \
    --logdir=/mnt/lustre/users/ynurmahomed/lightning_logs \
    --batch_size=16 \
    --lr=5e-5 \
    --max_epochs=3 \
    --num_workers=6 \
    --gpus=1
